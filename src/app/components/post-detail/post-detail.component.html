<div class="post-detail-container" *ngIf="post$ | async as post; else loading">
  <mat-card>
    <mat-card-header>
      <div mat-card-avatar class="avatar-placeholder">
        <mat-icon>account_circle</mat-icon>
      </div>
      <mat-card-title>{{ post.title }}</mat-card-title>
      <mat-card-subtitle>
        Posted by {{ post.authorName || post.authorId }} on {{ post.createdAt.toDate() | date:'medium' }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p class="post-content">{{ post.content }}</p>
    </mat-card-content>

    <!-- Delete button for post owner -->
    <div class="post-actions" *ngIf="canDelete(post)">
      <button mat-button color="warn" (click)="deletePost(post)">
        <mat-icon>delete</mat-icon>
        删除帖子
      </button>
    </div>

    <mat-divider></mat-divider>

    <div class="actions-section">
      <!-- Rating Component will go here -->
      <div class="rating-placeholder">
        <h3>Rate this post:</h3>
        <app-rating [postId]="post.id!"></app-rating>
      </div>
    </div>
  </mat-card>

  <div class="comments-section-wrapper">
    <!-- Comments Component will go here -->
    <app-comment-section [postId]="post.id!"></app-comment-section>
  </div>
</div>

<ng-template #loading>
  <div class="loading-spinner">
    <p>Loading post...</p>
  </div>
</ng-template>
